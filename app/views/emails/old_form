
<% if @status == "QA" %>
  <div class="field">
    <%= f.label :subject %><br />
    <%= f.text_field :subject , :value=>"QA: #{@parent_campaign.client_name} #{@parent_campaign.name} - test# #{@parent_campaign.emails.where("status = ?" , "QA").count+1}" %>
    <!-- #{Time.now.to_formatted_s(:short)} -->
  </div>
  <div class="field">
    <%= f.label :recipients %><br />
   <%= f.select :recipients , @recipient_lists.collect {|x| [x.name , x.list] } , selected: [@recipient_lists.select {|list| list.name == "QA"}.first.name , @recipient_lists.select {|list| list.name == "QA"}.first.list]%>
  </div>
  <div class="hidden"><%= f.text_field :status , :value => "QA" %></div>

<%else%>

  <div class="field">
    <%= f.label :subject %><br />
    <%= f.text_field :subject , :value=>"#{@parent_campaign.name} - test# #{@parent_campaign.emails.where("status = ?" , "Testing").count+1}" %>
  </div>
  
   <div class="field">
    <%= f.label :recipients %><br />

    <% if @recipient_lists.map {|list| list.preferred}.include?(true) %>
      <%= f.select :recipients , @recipient_lists.collect {|x| [x.name , x.list] } , selected: [@recipient_lists.select {|list| list.preferred}.first.name , @recipient_lists.select {|list| list.preferred}.first.list]%> <i>Using your preferred list</i> 
    <%else%>
      <%= f.select :recipients , @recipient_lists.collect {|x| [x.name , x.list] } , selected: [@recipient_lists.select {|list| list.name == "Testing"}.first.name , @recipient_lists.select {|list| list.name == "Testing"}.first.list]%> -> <i>Using the default "Testing" list</i>
    <%end%>

  </div>
  <div class="hidden"><%= f.text_field :status , :value => "Testing" %></div>
<%end%>